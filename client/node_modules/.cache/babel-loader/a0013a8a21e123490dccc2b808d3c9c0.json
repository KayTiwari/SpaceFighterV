{"ast":null,"code":"import _objectSpread from \"/Users/abhiktiwari/dev/assignments/projects/invisi/client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/Users/abhiktiwari/dev/assignments/projects/invisi/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/abhiktiwari/dev/assignments/projects/invisi/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/abhiktiwari/dev/assignments/projects/invisi/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/abhiktiwari/dev/assignments/projects/invisi/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/abhiktiwari/dev/assignments/projects/invisi/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/abhiktiwari/dev/assignments/projects/invisi/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/abhiktiwari/dev/assignments/projects/invisi/client/src/AppContext.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nvar todoAxios = axios.create();\ntodoAxios.interceptors.request.use(function (config) {\n  var token = localStorage.getItem('token');\n  config.headers.Authorization = \"Bearer \".concat(token);\n  return config;\n});\nvar AppContext = React.createContext();\nexport var AppContextProvider =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AppContextProvider, _Component);\n\n  function AppContextProvider() {\n    var _this;\n\n    _classCallCheck(this, AppContextProvider);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AppContextProvider).call(this));\n\n    _this.signup = function (userInfo) {\n      console.log('fired');\n      return axios.post('/auth/signup', userInfo).then(function (response) {\n        var _response$data = response.data,\n            user = _response$data.user,\n            token = _response$data.token;\n        localStorage.setItem('user', user);\n        localStorage.setItem('token', token);\n\n        _this.setState({\n          user: user,\n          token: token\n        });\n\n        return response;\n      });\n    };\n\n    _this.login = function (credentials) {\n      return axios.post('/auth/login', credentials).then(function (response) {\n        var _response$data2 = response.data,\n            token = _response$data2.token,\n            user = _response$data2.user;\n        localStorage.setItem('user', JSON.stringify(user));\n        localStorage.setItem('token', token);\n\n        _this.setState({\n          user: user,\n          token: token\n        });\n\n        return response;\n      });\n    };\n\n    _this.logout = function () {\n      localStorage.removeItem(\"user\");\n      localStorage.removeItem(\"token\");\n\n      _this.setState({\n        scores: [],\n        user: {},\n        token: \"\"\n      });\n    };\n\n    _this.getScores = function () {\n      return todoAxios.get(\"/api/scores\").then(function (response) {\n        _this.setState({\n          scores: response.data\n        });\n\n        console.log(response.data);\n        return response;\n      });\n    };\n\n    _this.postScores = function (newScore) {\n      return todoAxios.post(\"/api/scores/\", newScore).then(function (response) {\n        _this.setState(function (prevState) {\n          return {\n            scores: [].concat(_toConsumableArray(prevState.scores), [response.data])\n          };\n        });\n\n        return response;\n      });\n    };\n\n    _this.deleteScores = function (todoId) {\n      return todoAxios.delete(\"/api/todo/\".concat(todoId)).then(function (response) {\n        _this.setState(function (prevState) {\n          var updatedTodos = prevState.todos.filter(function (todo) {\n            return todo._id !== todoId;\n          });\n          return {\n            todos: updatedTodos\n          };\n        });\n\n        return response;\n      });\n    };\n\n    _this.state = {\n      scores: [],\n      user: JSON.parse(localStorage.getItem('user')) || {},\n      token: localStorage.getItem('token') || ''\n    };\n    return _this;\n  }\n\n  _createClass(AppContextProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.getScores();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(AppContext.Provider, {\n        value: _objectSpread({\n          getScores: this.getScores,\n          postScores: this.postScores,\n          deleteScores: this.deleteScores,\n          signup: this.signup,\n          login: this.login,\n          logout: this.logout\n        }, this.state),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, this.props.children);\n    }\n  }]);\n\n  return AppContextProvider;\n}(Component);\nexport var withProvider = function withProvider(Component) {\n  return function (props) {\n    return React.createElement(AppContext.Consumer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, function (globalState) {\n      return React.createElement(Component, Object.assign({}, globalState, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }));\n    });\n  };\n};","map":{"version":3,"sources":["/Users/abhiktiwari/dev/assignments/projects/invisi/client/src/AppContext.js"],"names":["React","Component","axios","todoAxios","create","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","AppContext","createContext","AppContextProvider","signup","userInfo","console","log","post","then","response","data","user","setItem","setState","login","credentials","JSON","stringify","logout","removeItem","scores","getScores","get","postScores","newScore","prevState","deleteScores","todoId","delete","updatedTodos","todos","filter","todo","_id","state","parse","props","children","withProvider","globalState"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\n\nconst todoAxios = axios.create();\n\ntodoAxios.interceptors.request.use(config => {\n    const token = localStorage.getItem('token')\n    config.headers.Authorization = `Bearer ${token}`\n    return config\n})\n\nconst AppContext = React.createContext();\n\nexport class AppContextProvider extends Component {\n    constructor() {\n        super()\n        this.state = {\n            scores: [],\n            user: JSON.parse(localStorage.getItem('user')) || {},\n            token: localStorage.getItem('token') || ''\n        }\n    }\n\n    signup = userInfo => {\n        console.log('fired')\n        return axios.post('/auth/signup', userInfo)\n            .then(response => {\n                const { user, token } = response.data\n                localStorage.setItem('user', user)\n                localStorage.setItem('token', token)\n                this.setState({\n                    user,\n                    token\n                })\n                return response\n            })\n        }\n\n    login = credentials => {\n        return axios.post('/auth/login', credentials)\n            .then(response => {\n                const {token, user} = response.data\n                localStorage.setItem('user', JSON.stringify(user))\n                localStorage.setItem('token', token)\n                this.setState({\n                    user,\n                    token\n                })\n                return response;\n            })\n    }\n\n    logout = () => {\n        localStorage.removeItem(\"user\");\n        localStorage.removeItem(\"token\");\n        this.setState({\n            scores: [],\n            user: {},\n            token: \"\"\n        })\n    }\n    componentDidMount() {\n        this.props.getScores()\n        }\n    \n\n    getScores = () => {\n        return todoAxios.get(\"/api/scores\")\n            .then(response => {\n                this.setState({ scores: response.data });\n                console.log(response.data);\n                return response;\n            })\n    }\n\n    postScores = (newScore) => {\n        return todoAxios.post(\"/api/scores/\", newScore)\n            .then(response => {\n                this.setState(prevState => {\n                    return { scores: [...prevState.scores, response.data] }\n                });\n                return response;\n            })\n    }\n\n\n    deleteScores = (todoId) => {\n        return todoAxios.delete(`/api/todo/${todoId}`)\n            .then(response => {\n                this.setState(prevState => {\n                    const updatedTodos = prevState.todos.filter(todo => {\n                        return todo._id !== todoId\n                    })\n                    return { todos: updatedTodos }\n                })\n                return response;\n            })\n    }\n\n    render() {\n        return (\n            <AppContext.Provider\n                value={{\n                    getScores: this.getScores,\n                    postScores: this.postScores,\n                    deleteScores: this.deleteScores,\n                    signup: this.signup,\n                    login: this.login,\n                    logout: this.logout,\n                    ...this.state\n                }}\n            >\n\n                {this.props.children}\n\n            </AppContext.Provider>\n        )\n    }\n}\n\n\nexport const withProvider = Component => {\n    return props => {\n        return (\n            <AppContext.Consumer>\n                {\n                    globalState => {\n                        return (\n                            <Component\n                                {...globalState}\n                                {...props}\n                            />\n                        )\n                    }\n                }\n            </AppContext.Consumer>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}